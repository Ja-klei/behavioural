---
title: "Behavioural Economics Experiment"
author: "Group 9"
date: "`r Sys.Date()`"
output: html_document
---

```{r packages}
library(tidyverse)
library(readxl)
library(janitor)
library(estimatr)
```

```{r data}
dat <- read_excel("~/Documents/Uni/Behaviroural Economics/Experiment/dat.xlsx", 
    sheet = "total")
```

```{r wrangling}
dat <- dat %>%
  mutate(d_m = m_cd - m_ab)

large_dat <- dat %>%
  filter(treatment == 1)

small_dat <- dat %>%
  filter(treatment == 0)
```

```{r large}
#part 1
large_dat %>%
  count(AB, CD)


#part 2
#mean test, using a regression on a constant only to get robust SE
model <- lm_robust(d_m ~ 1, data = large_dat, se_type = "HC3") 
  summary(model)
#sign test


#visualizations 
large_dat %>%
ggplot(aes(x = d_m)) +
  geom_histogram(aes(y = ..density..), bins = 30, fill = "forestgreen") +
  geom_density()

large_dat %>%
  ggplot(aes(x = AB, fill = CD))+
  geom_bar(position = "fill")
```

```{r small}
small_dat %>%
  count(AB, CD)

model <- lm_robust(d_m ~ 1, data = small_dat, se_type = "HC3") 
  summary(model)
  
small_dat %>%
ggplot(aes(x = d_m)) +
  geom_histogram(aes(y = ..density..), bins = 30, fill = "grey50") +
  geom_density()
```


